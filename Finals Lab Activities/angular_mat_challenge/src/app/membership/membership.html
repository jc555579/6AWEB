<div class="membership-wrapper" [class.dark-theme]="isDarkMode">
  <mat-card class="form-container mat-elevation-z4">
    <div class="header-row">
      <h2>Membership Registration</h2>
      <mat-slide-toggle [(ngModel)]="isDarkMode">
        <mat-icon>{{ isDarkMode ? 'dark_mode' : 'light_mode' }}</mat-icon>
      </mat-slide-toggle>
    </div>

    <mat-divider></mat-divider>
    <br>

    <form [formGroup]="formdata" (ngSubmit)="onClickSubmit(formdata.value)">

      <mat-form-field appearance="outline">
        <mat-label>Username</mat-label>
        <input matInput placeholder="Enter Text" formControlName="userName">
        <mat-icon matSuffix>person</mat-icon>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Email</mat-label>
        <input matInput type="email" placeholder="Enter Email" formControlName="email">
        <mat-icon matSuffix>email</mat-icon>
        @if (formdata.controls['email'].invalid && formdata.controls['email'].touched) {
          <mat-error>Valid email is required.</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Password</mat-label>
        <input matInput type="password" placeholder="Enter Password" formControlName="password">
        <mat-icon matSuffix>lock</mat-icon>
        <mat-hint>Min 8 chars, Alphanumeric, starts with a letter</mat-hint>
        @if (formdata.controls['password'].invalid && formdata.controls['password'].touched) {
          <mat-error>Invalid format (starts with letter, 8+ alphanumeric).</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Country</mat-label>
        <mat-select formControlName="country">
          @for (c of countries; track c) {
            <mat-option [value]="c">{{c}}</mat-option>
          }
        </mat-select>
      </mat-form-field>

      <div class="radio-group">
        <label class="radio-label">Gender</label>
        <mat-radio-group formControlName="gender" class="gender-radio-group">
          <mat-radio-button value="male">Male</mat-radio-button>
          <mat-radio-button value="female">Female</mat-radio-button>
        </mat-radio-group>
      </div>

      <mat-form-field appearance="outline">
        <mat-label>Birth Date</mat-label>
        <input matInput [matDatepicker]="picker" formControlName="birthDate" [max]="maxDate">
        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
        <mat-hint>Must be born in 2006 or earlier</mat-hint>
      </mat-form-field>

      <div class="toggle-group">
        <mat-checkbox formControlName="subscribe" color="primary">
          Notify updates via email
        </mat-checkbox>
      </div>

      <div class="slider-group">
        <label class="slider-label">Angular Skill: {{ formdata.get('angularSkillLevel')?.value }}</label>
        <mat-slider [min]="1" [max]="10" [step]="1" [discrete]="true">
          <input matSliderThumb formControlName="angularSkillLevel">
        </mat-slider>
      </div>

      <button mat-raised-button color="primary" type="submit" [disabled]="!formdata.valid" class="full-width">
        Complete Membership
      </button>
    </form>

    @if (submitted) {
      <mat-accordion class="result-accordion">
        <mat-expansion-panel [expanded]="true">
          <mat-expansion-panel-header>
            <mat-panel-title>Registration Successful</mat-panel-title>
          </mat-expansion-panel-header>

          <p><strong>User:</strong> {{ userName }} ({{ country }})</p>
          <p><strong>Email:</strong> {{ email }}</p>
          <p><strong>Birth Date:</strong> {{ birthDate | date:'longDate' }}</p>
          <p><strong>Skill Level:</strong> {{ angularSkillLevel }} / 10</p>
        </mat-expansion-panel>
      </mat-accordion>
    }
  </mat-card>
</div>
